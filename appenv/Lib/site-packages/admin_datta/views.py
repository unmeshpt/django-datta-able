from django.shortcuts import render, redirect
from admin_datta.forms import RegistrationForm, LoginForm, UserPasswordChangeForm, UserPasswordResetForm, UserSetPasswordForm
from django.contrib.auth.views import LoginView, PasswordChangeView, PasswordResetConfirmView, PasswordResetView
from django.views.generic import CreateView
from django.contrib.auth import logout
from profiles.models import *

from django.contrib.auth.decorators import login_required

@login_required(login_url='/accounts/login/')
def index(request):
  context = {
    'segment': 'index',
  }
  return render(request, "pages/index.html", context)


@login_required(login_url='/accounts/login/')
def icon_feather(request):
  context = {
    'parent': 'basic_components',
    'segment': 'feather_icon'
  }
  return render(request, "pages/components/icon-feather.html", context)

@login_required(login_url='/accounts/login/')
def tableview(request):
  context = {
    'parent': 'basic_components',
    'segment': 'Table'
  }
  return render(request, "pages/tbl_bootstrap.html", context)


# Authentication
class UserRegistrationView(CreateView):
  template_name = 'accounts/auth-signup.html'
  form_class = RegistrationForm
  success_url = '/accounts/login/'

class UserLoginView(LoginView):
  template_name = 'accounts/auth-signin.html'
  form_class = LoginForm

class UserPasswordResetView(PasswordResetView):
  template_name = 'accounts/auth-reset-password.html'
  form_class = UserPasswordResetForm

class UserPasswrodResetConfirmView(PasswordResetConfirmView):
  template_name = 'accounts/auth-password-reset-confirm.html'
  form_class = UserSetPasswordForm

class UserPasswordChangeView(PasswordChangeView):
  template_name = 'accounts/auth-change-password.html'
  form_class = UserPasswordChangeForm

def logout_view(request):
  logout(request)
  return redirect('index')

@login_required(login_url='/accounts/login/')
def profile(request):
  context = {
    'parent': 'profile',
    'segment': 'profile_page',
  }
  return render(request, 'pages/users/profile.html', context)
